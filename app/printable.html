<!DOCTYPE html>
<html>
<head>
    <style type="text/css">
    /* @page { 
        size: landscape;
    }
    body { 
        writing-mode: tb-rl;
    } */
    </style>
   <title>
       Printable Routine
   </title>
</head>
<body>
    
<script>

document.write('<div id = "a">');

    document.write('<div align = "center">');
    document.write('TRIBHUVAN UNIVERSITY  <br>  INSTITUTE OF ENGINEERING , PULCHOWK CAMPUS  <br>  Department of Computer and Electronics   Engineering  <br><br>');
    document.write('</div>');
    document.write('<table style="border-collapse: collapse;" cellpadding="15" border=1 id="top_table" align = "center">');
    document.write('<tr>');
    document.write('<th> ' + "Day/time" + '</th>');
    document.write('<th> ' + "10:15-12:00" + '</th>');
    document.write('<th> ' + "1:00-2:45" + '</th>');
    document.write('</tr>');
    var table = document.getElementById('top_table');

    var days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday"];
    const sqlite3 = require('sqlite3').verbose();
    var db_name = "dummydata.sqlite3";
    var db_Path = __dirname + "/" + db_name;
    var db = new sqlite3.Database(db_Path);


      for(var i = 0; i< days.length; i++){
    let sqlCommand = `SELECT Teacher Teacher, Subject Subject from death_eaters WHERE Day = "${days[i]}"`;

    let newRow = table.insertRow(i + 1);
        var newCell = newRow.insertCell(0);
        var newText = document.createTextNode(days[i]);
        newCell.appendChild(newText);
        let k = 0;

    db.all(sqlCommand, [], (err, rows)=>{
        if (err) {
            throw err;
        }
        // console.log(rows.length);
        rows.forEach((row)=>{
            // console.log(row.Teacher, row.Subject);
            k++;
            let newCell1 = newRow.insertCell(k);
            let newText1 = document.createTextNode(`${row.Teacher} - ${row.Subject}`);
            newCell1.appendChild(newText1);
        })
    })

 }

document.write('</table>');
document.write('</div>');

    
    function exportHTML(){
        var header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' " +
            "xmlns:w='urn:schemas-microsoft-com:office:word' " +
            "xmlns='http://www.w3.org/TR/REC-html40'>" +
            "<head><meta charset='utf-8'><title>Export HTML to Word Document with JavaScript</title></head><body>";
        var footer = "</body></html>";
        var sourceHTML = header + document.getElementById("a").innerHTML + footer;

        var source = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(sourceHTML);
        var fileDownload = document.createElement("a");
        document.body.appendChild(fileDownload);
        fileDownload.href = source;
        fileDownload.download = 'document.doc';
        fileDownload.click();
        document.body.removeChild(fileDownload);
    }


</script>



<button id="btn-export" onclick="exportHTML();">Export to
    word doc</button>

 

</body>
</html>